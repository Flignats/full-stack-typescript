<div class="view-documentation" [ngClass]="currentView$ | async">
	<h1 class="color-green">Secret Manager API Workflow</h1>
	<div class="intro color-grey">
		<div class="reference-gitbook">
			<a
				href="https://flignats.gitbook.io/full-stack-typescript/workflows/secret-manager-api-workflow"
				target="_blank"
				>Gitbook document</a
			>
		</div>
		<p>
			Secret Manager exposes a REST API and a gRPC API for using and
			managing secrets directly or in your applications.
		</p>
		<ul>
			<li>Enable Secret Manager for your project</li>
			<li>Create a secret</li>
			<li>Manage secret access</li>
			<li>Manage Functions access to secrets</li>
			<li>Access secrets from cloud functions</li>
			<li>Create utility function to get secrets from secret manager</li>
			<li>Retrieve secret from cloud function</li>
		</ul>
		<h2>
			Follow the Google provided instruction to enable the Secret Manager
			for your project.
		</h2>
		<p>
			Ref:
			<a
				href="https://cloud.google.com/secret-manager/docs/configuring-secret-manager"
				target="_blank"
				>https://cloud.google.com/secret-manager/docs/configuring-secret-manager</a
			>
		</p>
		<p>Key requirements:</p>
		<ul>
			<li>Create a project in the Google Cloud account</li>
			<li>Verify/enable billing for the project</li>
			<li>Enable Secrete Manager API for the project</li>
			<li>Install Google Cloud Cli</li>
			<li>Initialize Google Cloud Cli</li>
		</ul>
		<h2>Create a secret</h2>
		<p>
			Ref:
			<a
				href="https://cloud.google.com/secret-manager/docs/creating-and-accessing-secrets"
				target="_blank"
				>https://cloud.google.com/secret-manager/docs/creating-and-accessing-secrets</a
			>
		</p>
		<h2>Manage secret access</h2>
		<p>
			Ref:
			<a
				href="https://cloud.google.com/secret-manager/docs/manage-access-to-secrets"
				target="_blank"
				>https://cloud.google.com/secret-manager/docs/manage-access-to-secrets</a
			>
		</p>
		<h2>Manage Functions access to secrets</h2>
		<p>
			Ref:
			<a
				href="https://cloud.google.com/functions/docs/configuring/secrets"
				target="_blank"
				>https://cloud.google.com/functions/docs/configuring/secrets</a
			>
		</p>
		<h2>Access secrets from cloud functions</h2>
		<p>
			<b>Run</b> the following command to make sure the secret manager
			package is available in your project:
		</p>
		<pre><code [highlight]="installCommand"></code></pre>
		<p>
			<b>Update</b> the functions
			<span class="color-purple">package.json</span> with the new
			dependency.
		</p>
		<p>
			File:
			<span class="color-purple"> apps/**project**/src/package.json</span>
		</p>
		<h3>Create utility function to get secrets from secret manager</h3>
		<p>
			<b>Create</b> the file
			<span class="color-purple">get-secret-value.ts</span> in the utils
			folder:
			<span class="color-purple"
				>apps/**project**/src/utils/get-secret-value.ts</span
			>
		</p>
		<p><b>Add</b> the following code:</p>
		<pre><code [highlight]="utilCode"></code></pre>
		<h3>Retrieve secret from cloud function</h3>
		<p>
			The following example updates the
			<span class="color-purple">onGetBalance</span> Web3 function
			example.
		</p>
		<p>
			<b>Update</b>
			<span class="color-purple">
				apps/**project**/src/functions/moralis/index.ts</span
			>
			to the following:
		</p>
		<pre><code [highlight]="functionCode"></code></pre>
		<p>
			This above function is now ready to
			<span class="color-purple">build</span> and
			<span class="color-purple">deploy</span> with secure access to the
			secret.
		</p>
	</div>
</div>
